@if (isDefaultRoute) {
  <p-menubar [model]="menuItems" class="app-menubar"
    (click)="onMenubarItemClick()"
    (mouseleave)="onMenubarLeave()">
    <ng-template pTemplate="start">
      <span class="app-title">{{ title }}</span>
    </ng-template>
    <ng-template pTemplate="end">
      <div class="menubar-end">
        <span class="connection-status" [class]="connectionStatusClass">
          <i class="pi" [class.pi-check-circle]="connectionStatus === 'connected'" 
             [class.pi-spin]="connectionStatus === 'connecting' || connectionStatus === 'reconnecting'"
             [class.pi-spinner]="connectionStatus === 'connecting' || connectionStatus === 'reconnecting'"
             [class.pi-times-circle]="connectionStatus === 'disconnected' || connectionStatus === 'error'"></i>
          {{ connectionStatusLabel }}
        </span>
        @if (openfinStatus === 'connected') {
          <span class="openfin-status status-connected"
                [title]="openfinService.isPlatform ? 'Running in OpenFin Platform' : openfinService.isContainer ? 'Running in OpenFin Container' : 'OpenFin Web Broker connected'">
            <i class="pi pi-th-large"></i>
            {{ openfinService.isPlatform ? 'OpenFin Platform' : openfinService.isContainer ? 'OpenFin Container' : 'OpenFin Web' }}
          </span>
        }
        <button
          pButton
          type="button"
          (click)="toggleTheme()"
          class="p-button-text theme-toggle"
          aria-label="Toggle theme"
        >{{ themeLabel }}</button>
      </div>
    </ng-template>
  </p-menubar>

  <main #layoutContainer id="layout-container" class="openfin-layout-container"></main>

  <!-- Save Layout dialog -->
  <p-dialog
    header="Save Layout"
    [(visible)]="showSaveDialog"
    [modal]="true"
    [closable]="true"
    [style]="{ width: '400px' }"
    [draggable]="false"
  >
    <div class="save-layout-form">
      <label for="layoutName">Layout Name</label>
      <input
        pInputText
        id="layoutName"
        [(ngModel)]="saveLayoutName"
        placeholder="e.g. My Trading View"
        (keydown.enter)="confirmSaveLayout()"
        class="save-layout-input"
        autofocus
      />
    </div>
    <ng-template pTemplate="footer">
      <button pButton label="Cancel" class="p-button-text" (click)="showSaveDialog = false"></button>
      <button pButton label="Save" icon="pi pi-save" (click)="confirmSaveLayout()" [disabled]="!saveLayoutName.trim()"></button>
    </ng-template>
  </p-dialog>
}

<router-outlet></router-outlet>
